{% extends 'base.html' %}
{% block CSS %}
    <style>
        .f12 {
            font-size: 12px;
        }

        .fr {
            float: right;
            text-align: right;
        }
    </style>
{% endblock %}
{% block content %}
    <div class="container" id="wrapper">
    <div class="row">
        <div class="col-12 col-lg-9">
            <div class="header"><a href="{% url 'index' %}">2ZZY</a> <span class="chevron">&nbsp;›&nbsp;</span>
                我关注的人的最新话题
                <div class="fr f12"><span class="snow">话题总数&nbsp;</span> <strong
                        class="gray">{{ following_topic_obj.count }}</strong></div>
            </div>
            {% for obj in following_topic_obj %}
                <div class="card mb-2">
                    <div class="row no-gutters align-items-center">
                        <a href="{% url 'member' obj.author.username %}">
                            {% if obj.author.socialaccount_set.all.0.get_avatar_url %}
                                <img src="{{ obj.author.socialaccount_set.all.0.get_avatar_url }}" class="rounded"
                                     alt="{{ obj.author.username }}"
                                     width="48px" height="48px" border="0" align="default" style="margin-left: 10px">

                            {% else %}
                                <img src="{{ obj.author.avatar.url }}" class="rounded"
                                     alt="{{ obj.author.username }}"
                                     width="48px" height="48px" border="0" align="default" style="margin-left: 10px">
                            {% endif %}
                        </a>
                        <div class="col">

                            <div class="card-body" style="height: 80px">
                                <!-- 标题 -->
                                <h3 class="mt-0">
                                    <a href="{% url 'topic' obj.topic_sn %}">{{ obj.title|safe }}</a>
                                </h3>

                                <a class="node"
                                   href="{% url 'node' obj.category.code %}">{{ obj.category.name }}</a> &nbsp;•&nbsp;
                                <strong>
                                    <a href="{% url 'member' obj.author.username %}">{{ obj.author.username }}</a>
                                </strong>
                                <!-- 附加信息 -->
                                {% if obj.last_comment_user %}
                                    &nbsp;•&nbsp; {{ obj.last_comment_time }} &nbsp;•&nbsp; 最后回复来自
                                    <strong>
                                        <a href="{% url 'member' obj.last_comment_user %}">{{ obj.last_comment_user }}</a>
                                    </strong>
                                {% endif %}

                                <td width="70" align="right" valign="middle">
                                    <a href="{% url 'topic' obj.topic_sn %}"
                                       class="read_status badge badge-pill badge-secondary">&nbsp;{{ obj.comments.count }}&nbsp;</a>
                                </td>
                            </div>
                        </div>
                    </div>
                </div>

            {% endfor %}
        </div>
    <div class="col-lg-3 ">
            {% include 'rightslider.html' %}
             <div class="box">
            <div class="cell"><span>我关注的人</span></div>
            {% for obj in my_following_obj %}
                <div class="cell">
                    <a href="{% url 'member' obj.following.username %}">
                        <img src="{{ obj.following.avatar }}" class="rounded" border="0" width="24" height="24"
                             align="absmiddle">
                    </a>&nbsp; <a href="{% url 'member' obj.following.username %}">{{ obj.following.username }}</a>
                </div>
            {% endfor %}
        </div>
        </div>
    </div>
    </div>
{% endblock %}